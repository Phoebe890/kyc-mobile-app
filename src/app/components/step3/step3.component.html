<div class="kyc-container">
  <ion-card class="kyc-card">
    <div class="header-content">
      <div class="header-left">
        <div class="header-icon">
          <ion-icon name="mail"></ion-icon>
        </div>
        <div class="header-text">
          <h2>Contact Information</h2>
          <p>Please provide your email address for verification</p>
        </div>
      </div>
      <div class="completion-indicator">
        <div class="progress-circle">
          <svg width="40" height="40">
            <circle class="progress-ring-bg" cx="20" cy="20" r="16" />
            <circle class="progress-ring-circle" cx="20" cy="20" r="16"
                    [style.strokeDasharray]="100.5"
                    [style.strokeDashoffset]="0" />
          </svg>
          <span class="percentage">100%</span>
        </div>
        <div class="step-text">
          <span class="current-step">Step 3 of 3</span>
          <span class="step-label">Final Step</span>
        </div>
      </div>
    </div>

    <app-step-progress [currentStep]="3"></app-step-progress>

    <form [formGroup]="emailForm" class="form-section" (ngSubmit)="onSubmit()">
      <div class="form-header">
        <h3 class="form-title">Email Address</h3>
        <p class="form-description">We'll send you important updates and notifications here</p>
      </div>

      <ion-item class="form-item" lines="none">
        <ion-label position="stacked">Email address</ion-label>
        <ion-input
          formControlName="email"
          type="email"
          placeholder="e.g., name@example.com">
        </ion-input>
        <ion-icon name="mail-outline" slot="end"></ion-icon>
      </ion-item>

      <p class="form-hint">We'll never share your email with anyone else</p>
      <span *ngIf="emailForm.get('email')?.hasError('required') && emailForm.get('email')?.touched" class="error-message visible" role="alert">
        Email address is required
      </span>
      <span *ngIf="emailForm.get('email')?.hasError('email') && emailForm.get('email')?.touched" class="error-message visible" role="alert">
        Please enter a valid email address
      </span>


      <div class="action-buttons">
        <ion-button fill="outline"
                class="back-button nav-button"
                type="button"
                [disabled]="isSubmitting"
                (click)="onBack()"
                aria-label="Back button">
          <ion-icon name="arrow-back" slot="start"></ion-icon>
          Back
        </ion-button>
        <ion-button fill="solid"
                color="primary"
                class="next-button nav-button submit-button"
                type="submit"
                [disabled]="emailForm.invalid || isSubmitting"
                (click)="onSubmit()"
                aria-label="Submit button">
          <span>Submit</span>
          <ion-icon *ngIf="!isSubmitting" name="send" slot="end"></ion-icon>
          <mat-spinner *ngIf="isSubmitting" diameter="20" class="spinner-in-button"></mat-spinner>
        </ion-button>
      </div>
    </form>
  </ion-card>
</div>